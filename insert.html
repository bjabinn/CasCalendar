<html>
    <head>        
        <link href="https://fonts.googleapis.com/css?family=Montserrat%3A400%2C700%7CBitter%3A400%2C700&display=swap" rel="stylesheet" nonce="">
        <link href="https://fonts.googleapis.com/css?family=Bitter%3Ai%2Cbi%2C700%2C400%2C500%7CMontserrat%3Ai%2Cbi%2C700%2C400&amp;display=swap" rel="stylesheet" nonce="">        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.css"/>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js"></script>        
        <link rel="stylesheet" href="./myThemeInsert.css" />
        <title>TORNEOS AJEDREZ</title>
    </head>
    <body>   
        <div id="cabecera">
            <div id="outerLogo">
                <img id="logo" src="./logoRedondoSinLetras.jpg">
            </div>
            <div id="letreros">
                <spam id="letrero1">Casa del Ajedrez de Sevilla</spam>
                <spam id="letrero2">Informaci贸n pr贸ximos torneos adaptada a padres y jugadores noveles</spam>
            </div>
        </div>     
        <div class="form-group" id="formulario">
            <div class="form-group">
                <label for="nombreTorneo">Nombre:</label>
                <input type="text" class="form-control" id="nombreTorneo" name="nombreTorneo" placeholder="Nombre del torneo">
                <div id="validationNombreTorneo" class="oculto validationField">El nombre del torneo no puede estar vacio</div>
            </div>
            
            
            <div class="form-group">
                <label for="urlBases">Bases (url): </label>
                <input type="text" class="form-control" id="urlBases" name="urlBases" placeholder="url bases">
            </div>


            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="sistemaDeJuego">Sistema de Juego:</label>
                    <input type="text" class="form-control" id="sistemaDeJuego" name="sistemaDeJuego placeholder="N rondas. 10+3">                    
                </div>

                <div class="form-group col-md-3">
                    <label for="precio">Precio: </label>
                    <input type="text" class="form-control" id="precio" name="precio" placeholder="Precio">
                </div>

                <div class="form-group col-md-3">
                    <label for="comienzo">Comienzo: </label>                     
                    <input type="text" id="comienzo" class="datetimepicker form-control" />                    
                </div>
                
                <div class="form-group col-md-3">
                    <label for="fin">Fin: </label>
                    <input type="text" id="fin" class="datetimepicker form-control" />                    
                </div>
            </div>

            <div class="form-group">
                <label for="lugar">Lugar: </label>
                <input type="text" class="form-control" id="lugar" name="lugar" placeholder="Direcci贸n de juego">                
            </div>

            <div class="form-row" style="text-align: center; border: 1px solid #ced4da; border-radius: 5px; height: calc(1.5em + .75rem + 2px); padding: .375rem 1rem;">
                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chksub8" value="sub8">
                    <label class="form-check-label" for="chksub8">Sub8</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chksub10" value="sub10">
                    <label class="form-check-label" for="chksub8">Sub10</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chksub12" value="sub12">
                    <label class="form-check-label" for="chksub8">Sub12</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chksub14" value="sub14">
                    <label class="form-check-label" for="chksub8">Sub14</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chksub16" value="sub16">
                    <label class="form-check-label" for="chksub6">Sub16</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chkSupra50" value="subSupra50">
                    <label class="form-check-label" for="chksub8">Supra50</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chkSupra65" value="subSupra65">
                    <label class="form-check-label" for="chksub8">Supra65</label>
                </div>

                <div class="col-md-1">
                    <input class="form-check-input" type="checkbox" id="chkFemenino" value="subFemenino">
                    <label class="form-check-label" for="chksub8">Femenino</label>
                </div>
            </div>

            <div class="form-group"><label for="notas">Notas</label> <input type="text" class="form-control" id="notas" name="notas" placeholder="Notas"></div>


            <button id="aceptar" type="button" class="btn btn-primary">Aceptar</button>

            <table id="eventos" class="table"></table>
            
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Notificaci贸n</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body" id="modal-content">
                      Evento guardado satisfactoriamente
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>                      
                    </div>
                  </div>
                </div>
              </div>

        </div>     
                
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

        <script type="text/javascript">
            $(document).ready(function() {                
                $("#aceptar").click(function() {                       
                    var nombreTorneo = $("#nombreTorneo").val();
                    var sistemaDeJuego = $("#sistemaDeJuego").val();
                    var precio = $("#precio").val();
                    var urlBases = $("#urlBases").val();
                    var comienzo = $("#comienzo").val();
                    var fin = $("#fin").val();
                    var location = $("#lugar").val();
                    var notas = $("#notas").val();

                    //var comienzoConverted = comienzo.replace(/\//g, "-");
                    var date_horaComienzo = comienzo.split(" ");
                    var soloDateComienzoYMD= date_horaComienzo[0].split("-");
                    var comienzoConverted = soloDateComienzoYMD[2] + "-" + soloDateComienzoYMD[1] + "-" + soloDateComienzoYMD[0] + " " + date_horaComienzo[1];

                    //var finConverted = fin.replace(/\//g, "-");                    
                    var date_horaFin = fin.split(" ");
                    var soloDateFinYMD= date_horaComienzo[0].split("-");
                    var finConverted = soloDateFinYMD[2] + "-" + soloDateFinYMD[1] + "-" + soloDateFinYMD[0] + " " + date_horaFin[1];

                    if (checkFieldsValidation() == false){
                        return;
                    }

                    var objeto = {                        
                        "nombreTorneo": nombreTorneo,
                        "sistemaDeJuego": sistemaDeJuego,
                        "precio": precio,
                        "basesURL": urlBases,                        
                        "comienzo": comienzoConverted,
                        "fin": finConverted,
                        "location": location,
                        "notas": notas,
                        "visible": true
                    };

                    var json = JSON.stringify(objeto);

                    //http://localhost:8080
                    $.ajax({
                        url: "https://cas-calendar-api.herokuapp.com/calendar",
                        type: "POST",
                        data: json, 
                        contentType: "application/json",                        
                        success: function(response) {                                                    
                            $('#myModal').modal('toggle');
                        },
                        error: function(xhr, status, error) {                            
                            console.log(error);
                        }
                    });
                }); //end of click on aceptar

            }); //end of document ready

            $(".datetimepicker").each(function () {
               $(this).datetimepicker({
                    value: new Date(),
                    format: 'd-m-Y H:i'
                });            
            });

            function ocultarAlertaNombreTorneo(){
                $("#validationNombreTorneo").removeClass("visible").addClass("oculto");  
            }

            function checkFieldsValidation() {
                var isEverythingOK = true;
                if ($("#nombreTorneo").val().trim()==""){                    
                    $("#validationNombreTorneo").removeClass("oculto").addClass("visible");                    
                    isEverythingOK = false;
                }
                return isEverythingOK;
            }


            function refrescaTabla(){
                $.ajax({
                    url: "http://localhost:8080/calendar",
                    type: "GET",
                    data: json, 
                    contentType: "application/json",                        
                    success: function(response) {                        
                        $("#tablaEventos").innerHTML("<thead><tr><th scope='col'>Torneo</th></tr></thead><tbody>");                        
                        for (var i=0; i < response.length; i++){
                            var evento = response[i];
                        }
                        "<tr><td>Mark</td></tr><tr><td>Jacob</td></tr><tr><td>Larry</td></tr></tbody>"
                    },
                    error: function(xhr, status, error) {                            
                        console.log(error);
                    }
                });
            }
          </script>
       

        <script>
            
        </script>

    </body>
</html>